# Safari AddPrinter.exe URL scheme exploit

This exploit is not user assisted and is quite tricky to hide for the non-technical.

## What it does

A user will see something that looks like this upon visiting a website (driveby)

Pressing the Enter or Escape buttons will simply open up the window again.

The AddPrinter program can NOT be seen in the Dock or Force Quit window.

![Screenshot](https://i.imgur.com/c4AFW2w.png)

## How it works

This abuses Safari's broken URL scheme system, where it doesn't even prompt the user if they would like to open the application.

This "creates" a printer using the `ipp://` endpoint with the name specified, prefixed and suffixed with newline characters.

## I want to see the code!

[Here you go.](https://github.com/justinoboyle/safari-exploits/blob/master/urlscheme/printsetup.js)

## I want a demo!

[Coming soon](/dev/null)
